import{S as t,i as e,s as r,u as n,w as i,x as a,d as o,A as s,f as u,B as c,F as l,n as d,L as f,p as h}from"./client.8a3e1c52.js";function v(t,e,r){const n=t.createShader(e);t.shaderSource(n,r),t.compileShader(n);if(!t.getShaderParameter(n,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(n);throw t.deleteShader(n),new Error(`Shader compilation error: ${e}`)}return n}function p(t,e,r=null){const n=document.getElementById(e);if(!n)throw new Error(`Couldn't find shader script element wit id #${e}`);if(null==r)if("x-shader/x-vertex"===n.type)r=t.VERTEX_SHADER;else if("x-shader/x-fragment"===n.type)r=t.FRAGMENT_SHADER;else if(r!==t.VERTEX_SHADER&&r!==t.FRAGMENT_SHADER)throw new Error(`Unknown shader type: ${r}`);return v(t,t.VERTEX_SHADER,n.textContent)}function m(t,e,r){const n=t.createProgram();t.attachShader(n,e),t.attachShader(n,r),t.linkProgram(n);if(!t.getProgramParameter(n,t.LINK_STATUS)){const e=t.getProgramInfoLog(n);throw t.deleteProgram(n),new Error(`Error while linking WebGL program: ${e}`)}return n}var _={createShaderFromSource:v,createShaderFromScript:p,createProgram:m,createProgramFromSources:function(t,e,r){return m(t,v(t,t.VERTEX_SHADER,e),v(t,t.FRAGMENT_SHADER,r))},createProgramFromScripts:function(t,e,r){return m(t,p(t,e),p(t,r))},getActiveAttributes:function*(t,e){const r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<r;n++){const r=t.getActiveAttrib(e,n);if(!r)break;yield r}},pointVertexAttrib:function(t,e,r,n=WebGL2RenderingContext.FLOAT,i=!1,a=0,o=0){t.enableVertexAttribArray(e),t.vertexAttribPointer(e,r,n,i,a,o)},clear:function(t,e=0,r=0,n=0,i=0){t.clearColor(e,r,n,i),t.clear(t.COLOR_BUFFER_BIT)},rectangle:function(t,e,r,n){return[t,e,r,e,t,n,t,n,r,e,r,n]}};class g{constructor(t,e,r=16,n=10,i=null){this.name=t,this.code=e,this.n=r,this.speed=n,this.comments=i||new Array(t)}}const A={},w=[],y=[];function R(t,e){A[t]=e,w.push(t)}function x(t,e){A[t]=e,y.push(t)}function b(t){return A[t]}function E(t){let e,r,d;return{c(){e=n("canvas"),this.h()},l(t){e=i(t,"CANVAS",{width:!0,height:!0,class:!0}),a(e).forEach(o),this.h()},h(){s(e,"width",t[0]),s(e,"height",t[0]),s(e,"class","svelte-szljto")},m(n,i){u(n,e,i),t[10](e),r||(d=c(e,"click",t[11]),r=!0)},p(t,[r]){1&r&&s(e,"width",t[0]),1&r&&s(e,"height",t[0])},i:l,o:l,d(n){n&&o(e),t[10](null),r=!1,d()}}}function S(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,a){function o(t){try{u(n.next(t))}catch(t){a(t)}}function s(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))};let i,a,o,s,u,c,l,v,p,m,g,A,w,y,{time:R}=e,{speed:x}=e,{code:b}=e,{n:E}=e,{resolution:S=800}=e,F=d();function T(t,e){y=_.rectangle(0,0,1/e,1/e),t.bindBuffer(t.ARRAY_BUFFER,m),t.bufferData(t.ARRAY_BUFFER,new Float32Array(y),t.STATIC_DRAW),t.uniform2f(c,t.canvas.width,t.canvas.height),t.vertexAttrib1f(v,1/e/2),w=[];for(let t=0;t<e;t++)for(let r=0;r<e;r++)w.push((r+.5)/e,(t+.5)/e);t.bindBuffer(t.ARRAY_BUFFER,g),t.bufferData(t.ARRAY_BUFFER,new Float32Array(w),t.STATIC_DRAW)}function B(){a.useProgram(o),_.clear(a),function(){let t=[];for(let i=0;i<E;i++)for(let a=0;a<E;a++)t.push((e=s(C,a+i*E,a,i,E),r=-1,n=1,Math.min(Math.max(e,r),n)));var e,r,n;a.bindBuffer(a.ARRAY_BUFFER,A),a.bufferData(a.ARRAY_BUFFER,new Float32Array(t),a.STATIC_DRAW)}(),a.bindBuffer(a.ARRAY_BUFFER,A),_.pointVertexAttrib(a,p,1),a.vertexAttribDivisor(p,1),a.drawArraysInstanced(a.TRIANGLES,0,y.length/2,E*E)}f((()=>n(void 0,void 0,void 0,(function*(){r(7,a=i.getContext("webgl2")),o=_.createProgramFromSources(a,"\n\t\t\tuniform vec2 u_resolution;\n\t\t\tattribute vec2 a_position;\n\t\t\tattribute vec2 a_center;\n\t\t\tattribute float a_radius;\n\t\t\tattribute float a_transform;\n\n\t\t\tvarying vec2 v_resolution;\n\t\t\tvarying vec2 v_center;\n\t\t\tvarying float v_radius;\n\t\t\tvarying float v_transform;\n\n\t\t\tvoid main() {\n\t\t\t\tvec2 pos = (a_position + a_center + vec2(-a_radius, -a_radius)) * vec2(2,-2) + vec2(-1,1);\n\t\t\t\tgl_Position = vec4(pos,0,1);\n\n\t\t\t\tv_resolution = u_resolution;\n\t\t\t\tv_center = a_center;\n\t\t\t\tv_radius = a_radius;\n\t\t\t\tv_transform = a_transform;\n\t\t\t}\n\t\t","\n\t\t\tprecision mediump float;\n\n\t\t\tvarying vec2 v_resolution;\n\t\t\tvarying vec2 v_center;\n\t\t\tvarying float v_radius;\n\t\t\tvarying float v_transform;\n\n\t\t\tvoid main() {\n\t\t\t\tvec2 normalizedCoord = gl_FragCoord.xy/v_resolution * vec2(1,-1) + vec2(0,+1);\n\n\t\t\t\tfloat dx = v_center[0] - normalizedCoord.x;\n\t\t\t\tfloat dy = v_center[1] - normalizedCoord.y;\n\n\t\t\t\tfloat distance = sqrt(dx*dx + dy*dy);\n\t\t\t\tfloat radius = v_radius * abs(v_transform);\n\t\t\t\tvec4 color = v_transform < .0 ? vec4(1,0,0,1) : vec4(1,1,1,1);\n\n\t\t\t\tgl_FragColor += color * smoothstep(radius, radius-0.003, distance);\n\t\t\t}\n\t\t"),c=a.getUniformLocation(o,"u_resolution"),v=a.getAttribLocation(o,"a_radius"),l=a.getAttribLocation(o,"a_center"),g=a.createBuffer(),u=a.getAttribLocation(o,"a_position"),m=a.createBuffer(),p=a.getAttribLocation(o,"a_transform"),A=a.createBuffer(),a.viewport(0,0,a.canvas.width,a.canvas.height),T(a,E),a.bindBuffer(a.ARRAY_BUFFER,g),_.pointVertexAttrib(a,l,2),a.vertexAttribDivisor(l,1),a.bindBuffer(a.ARRAY_BUFFER,m),_.pointVertexAttrib(a,u,2),B()}))));let C;return t.$$set=t=>{"time"in t&&r(3,R=t.time),"speed"in t&&r(4,x=t.speed),"code"in t&&r(5,b=t.code),"n"in t&&r(6,E=t.n),"resolution"in t&&r(0,S=t.resolution)},t.$$.update=()=>{24&t.$$.dirty&&r(9,C=R/1e4*x),656&t.$$.dirty&&a&&0!=x&&C&&B(),192&t.$$.dirty&&a&&E&&(T(a,E),B()),32&t.$$.dirty&&b&&r(8,s=function(t){try{return new Function("t","i","x","y","n",`\n\t\t\ttry {\n\t\t\t\twith(Math) {\n\t\t\t\t\t${t}\n\t\t\t\t};\n\t\t\t} catch(e) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t`)}catch(t){return()=>1}}(b)),384&t.$$.dirty&&a&&s&&B()},[S,i,F,R,x,b,E,a,s,C,function(t){h[t?"unshift":"push"]((()=>{i=t,r(1,i)}))},()=>F("click")]}R("sweep_up",new g("Sweep up","return sin(y/8+t);",16)),R("pulse",new g("Pulse","return sin(t);",16)),R("ripple_in",new g("Ripple In","return sin(sqrt(pow(n/2-x-0.5,2)+pow(n/2-y-0.5,2))+t);",16)),R("ripple_circ",new g("Circular Ripple","let radius = n/4;return sin(sqrt(pow(n/2-x-0.5+sin(t)*radius,2)+pow(n/2-y-0.5+cos(t)*radius,2))+t);",16)),R("triangle",new g("Triangle","return y+1>x && n-2-y<x;",16,0)),R("triangle-up",new g("Flying Triangle","let h=t*3%n;return y>x-h && y>n-1-x-h && y<n-h;",16)),R("grid",new g("Grid","return x%4 && y%4",16)),R("sirpinski",new g('<a href="https://en.wikipedia.org/wiki/Sierpi%C5%84ski_triangle">Sirpinski </a>',"return i & x & y & t*2",16)),x("tut-start",new g("","return sin(y/8+t);",16,10,['Inspired by <a href="https://tixy.land">tixy.land</a>',"Start the tutorial by clicking the dots"])),x("tut-visibility",new g("","return i%3 == 0;",16,0,["0/1 = false/true => hide/show dots"])),x("tut-scale",new g("","return abs(sin(x/3))",16,0,["use a number from 0 to 1 to define the dot size"])),x("tut-time",new g("","return sin(t);",16,10,["'t' is the time in seconds"])),x("tut-index",new g("","return i/pow(n,2);",16,0,["'i' is the index of the dot, from 0 to nÂ²-1"])),x("tut-x",new g("","return x/n;",16,0,["'x' is the column, 0..n-1"])),x("tut-y",new g("","return y/n;",16,0,["'y' is the row, 0..n-1"])),x("tut-color",new g("","return y-(n/2-0.5);",16,0,["positive numbers are white","negatives are red"])),x("tut-animate",new g("","return y-t;",16,10,["use 't' to animate values"])),x("tut-animate-faster",new g("","return y-t*2;",16,10,["multiply 't' to change the speed"])),x("tut-pattern",new g("","return [0.25, -0.5, 0.75, -1][i%4]",16,0,["Create patterns using arrays"])),x("tut-end",new g("","return sin(t)",16,10,["Edit the code to create your own","Have fun :)"]));class F extends t{constructor(t){super(),e(this,t,S,E,r,{time:3,speed:4,code:5,n:6,resolution:0})}}export{F as C,w as a,b as g,y as t};
