import{S as t,i as e,s as r,j as n,k as i,l as a,d as o,A as s,f as u,n as c,F as l,w as d,x as f,y as h}from"./client.32ac8017.js";function v(t,e,r){const n=t.createShader(e);t.shaderSource(n,r),t.compileShader(n);if(!t.getShaderParameter(n,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(n);throw t.deleteShader(n),new Error(`Shader compilation error: ${e}`)}return n}function p(t,e,r=null){const n=document.getElementById(e);if(!n)throw new Error(`Couldn't find shader script element wit id #${e}`);if(null==r)if("x-shader/x-vertex"===n.type)r=t.VERTEX_SHADER;else if("x-shader/x-fragment"===n.type)r=t.FRAGMENT_SHADER;else if(r!==t.VERTEX_SHADER&&r!==t.FRAGMENT_SHADER)throw new Error(`Unknown shader type: ${r}`);return v(t,t.VERTEX_SHADER,n.textContent)}function m(t,e,r){const n=t.createProgram();t.attachShader(n,e),t.attachShader(n,r),t.linkProgram(n);if(!t.getProgramParameter(n,t.LINK_STATUS)){const e=t.getProgramInfoLog(n);throw t.deleteProgram(n),new Error(`Error while linking WebGL program: ${e}`)}return n}var _={createShaderFromSource:v,createShaderFromScript:p,createProgram:m,createProgramFromSources:function(t,e,r){return m(t,v(t,t.VERTEX_SHADER,e),v(t,t.FRAGMENT_SHADER,r))},createProgramFromScripts:function(t,e,r){return m(t,p(t,e),p(t,r))},getActiveAttributes:function*(t,e){const r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<r;n++){const r=t.getActiveAttrib(e,n);if(!r)break;yield r}},pointVertexAttrib:function(t,e,r,n=WebGL2RenderingContext.FLOAT,i=!1,a=0,o=0){t.enableVertexAttribArray(e),t.vertexAttribPointer(e,r,n,i,a,o)},clear:function(t,e=0,r=0,n=0,i=0){t.clearColor(e,r,n,i),t.clear(t.COLOR_BUFFER_BIT)},rectangle:function(t,e,r,n){return[t,e,r,e,t,n,t,n,r,e,r,n]}};class A{constructor(t,e,r=16,n=(A.DEFAULT_SPEED=100),i=null){this.name=t,this.code=e,this.n=r,this.speed=n,this.comments=i||new Array(t)}}A.DEFAULT_SPEED=100;const g={},y=[],w=[];function E(t,e){g[t]=e,y.push(t)}function x(t,e){g[t]=e,w.push(t)}E("sweep_up",new A("Sweep up","return sin(y/8+t);",16)),E("pulse",new A("Pulse","return sin(t);",16)),E("ripple_in",new A("Ripple In","return sin(sqrt(pow(n/2-x-0.5,2)+pow(n/2-y-0.5,2))+t);",16)),E("ripple_circ",new A("Circular Ripple","let radius = n/4;return sin(sqrt(pow(n/2-x-0.5+sin(t)*radius,2)+pow(n/2-y-0.5+cos(t)*radius,2))+t);",16)),E("triangle",new A("Triangle","return y+1>x && n-2-y<x;",16,0)),E("triangle-up",new A("Flying Triangle","let h=t*3%n;return y>x-h && y>n-1-x-h && y<n-h;",16)),E("grid",new A("Grid","return x%4 && y%4",16)),E("sirpinski",new A('<a href="https://en.wikipedia.org/wiki/Sierpi%C5%84ski_triangle">Sirpinski </a>',"return i & x & y & t*2",16)),E("square-collapse",new A("Collapsing Square","let v = ceil(t%(n/2)-1);return (x == v || n-1-x == v || y == v || n-1-y == v) && (x>v-1 && x<n-v && y>v-1 && y<n-v)")),E("ladder-blink",new A("Blinking Ladder","let px = floor(t%n);let py = floor((t/n)%n);return (x == (py%2 ? px : n-1-px) && y == py) * (i%2*-2+1)",6,2*A.DEFAULT_SPEED)),E("swipper",new A("Swipper","return abs(floor(sin(t)*(n-1))) == x",16)),x("tut-start",new A("","return sin(y/8+t);",16,A.DEFAULT_SPEED,['Inspired by <a href="https://tixy.land">tixy.land</a>',"Start the tutorial by clicking the dots"])),x("tut-visibility",new A("","return i%3 == 0;",16,0,["0/1 = false/true => hide/show dots"])),x("tut-scale",new A("","return abs(sin(x/3))",16,0,["use a number from 0 to 1 to define the dot size"])),x("tut-time",new A("","return sin(t);",16,A.DEFAULT_SPEED,["'t' is the time in seconds"])),x("tut-index",new A("","return i/pow(n,2);",16,0,["'i' is the index of the dot, from 0 to nÂ²-1"])),x("tut-x",new A("","return x/n;",16,0,["'x' is the column, 0..n-1"])),x("tut-y",new A("","return y/n;",16,0,["'y' is the row, 0..n-1"])),x("tut-color",new A("","return y-(n/2-0.5);",16,0,["positive numbers are white","negatives are red"])),x("tut-animate",new A("","return y-t;",16,A.DEFAULT_SPEED,["use 't' to animate values"])),x("tut-animate-faster",new A("","return y-t*2;",16,A.DEFAULT_SPEED,["multiply 't' to change the speed"])),x("tut-pattern",new A("","return [0.25, -0.5, 0.75, -1][i%4]",16,0,["Create patterns using arrays"])),x("tut-end",new A("","return sin(t)",16,A.DEFAULT_SPEED,["Edit the code to create your own","Have fun :)"]));var S={get:function(t){return g[t]},gallery:y,tutorial:w,createTransformFunction:function(t){let e,r=!1;try{e=new Function("t","i","x","y","n",`\n\t\t\t\ttry {\n\t\t\t\t\twith(Math) {\n\t\t\t\t\t\t${t}\n\t\t\t\t\t};\n\t\t\t\t} catch(e) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t`)}catch(t){r=!0}return[e,r]},adjustFrame:function(t,e){return t/1e4*e},frameAdjustmentFactor:1e4};var R={vertexShaderSource:"\n\tuniform vec2 u_resolution;\n\tattribute vec2 a_position;\n\tattribute vec2 a_center;\n\tattribute float a_radius;\n\tattribute float a_transform;\n\n\tvarying vec2 v_resolution;\n\tvarying vec2 v_center;\n\tvarying float v_radius;\n\tvarying float v_transform;\n\n\tvoid main() {\n\t\tvec2 pos = (a_position + a_center + vec2(-a_radius, -a_radius)) * vec2(2,-2) + vec2(-1,1);\n\t\tgl_Position = vec4(pos,0,1);\n\n\t\tv_resolution = u_resolution;\n\t\tv_center = a_center;\n\t\tv_radius = a_radius;\n\t\tv_transform = a_transform;\n\t}\n",fragmentShaderSource:"\n\tprecision mediump float;\n\n\tvarying vec2 v_resolution;\n\tvarying vec2 v_center;\n\tvarying float v_radius;\n\tvarying float v_transform;\n\n\tvoid main() {\n\t\tvec2 normalizedCoord = gl_FragCoord.xy/v_resolution * vec2(1,-1) + vec2(0,+1);\n\n\t\tfloat dx = v_center[0] - normalizedCoord.x;\n\t\tfloat dy = v_center[1] - normalizedCoord.y;\n\n\t\tfloat distance = sqrt(dx*dx + dy*dy);\n\t\tfloat radius = v_radius * abs(v_transform);\n\t\tvec4 color = v_transform < .0 ? vec4(1,0,0,1) : vec4(1,1,1,1);\n\n\t\tgl_FragColor += color * smoothstep(radius, radius-0.003, distance);\n\t}\n"};function F(t){return!isNaN(t)}function b(t){let e,r,d;return{c(){e=n("canvas"),this.h()},l(t){e=i(t,"CANVAS",{width:!0,height:!0,class:!0}),a(e).forEach(o),this.h()},h(){s(e,"width",t[0]),s(e,"height",t[0]),s(e,"class","svelte-szljto")},m(n,i){u(n,e,i),t[11](e),r||(d=c(e,"click",t[12]),r=!0)},p(t,[r]){1&r&&s(e,"width",t[0]),1&r&&s(e,"height",t[0])},i:l,o:l,d(n){n&&o(e),t[11](null),r=!1,d()}}}function T(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,a){function o(t){try{u(n.next(t))}catch(t){a(t)}}function s(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,s)}u((n=n.apply(t,e||[])).next())}))};let i,a,o,s,u,c,l,v,p,m,A,g,y,w,{frame:E}=e,{speed:x}=e,{hasErrorInCode:F=!1}=e,{code:b}=e,{n:T}=e,{resolution:D=800}=e,P=d();function C(t,e){w=_.rectangle(0,0,1/e,1/e),t.bindBuffer(t.ARRAY_BUFFER,m),t.bufferData(t.ARRAY_BUFFER,new Float32Array(w),t.STATIC_DRAW),t.uniform2f(c,t.canvas.width,t.canvas.height),t.vertexAttrib1f(v,1/e/2),y=[];for(let t=0;t<e;t++)for(let r=0;r<e;r++)y.push((r+.5)/e,(t+.5)/e);t.bindBuffer(t.ARRAY_BUFFER,A),t.bufferData(t.ARRAY_BUFFER,new Float32Array(y),t.STATIC_DRAW)}function B(){a.useProgram(o),_.clear(a),function(){let t=[];for(let i=0;i<T;i++)for(let a=0;a<T;a++)t.push((e=s(L,a+i*T,a,i,T),r=-1,n=1,Math.min(Math.max(e,r),n)));var e,r,n;a.bindBuffer(a.ARRAY_BUFFER,g),a.bufferData(a.ARRAY_BUFFER,new Float32Array(t),a.STATIC_DRAW)}(),a.bindBuffer(a.ARRAY_BUFFER,g),_.pointVertexAttrib(a,p,1),a.vertexAttribDivisor(p,1),a.drawArraysInstanced(a.TRIANGLES,0,w.length/2,T*T)}f((()=>n(void 0,void 0,void 0,(function*(){r(8,a=i.getContext("webgl2")),o=_.createProgramFromSources(a,R.vertexShaderSource,R.fragmentShaderSource),c=a.getUniformLocation(o,"u_resolution"),v=a.getAttribLocation(o,"a_radius"),l=a.getAttribLocation(o,"a_center"),A=a.createBuffer(),u=a.getAttribLocation(o,"a_position"),m=a.createBuffer(),p=a.getAttribLocation(o,"a_transform"),g=a.createBuffer(),a.viewport(0,0,a.canvas.width,a.canvas.height),C(a,T),a.bindBuffer(a.ARRAY_BUFFER,A),_.pointVertexAttrib(a,l,2),a.vertexAttribDivisor(l,1),a.bindBuffer(a.ARRAY_BUFFER,m),_.pointVertexAttrib(a,u,2),B()}))));let L;return t.$$set=t=>{"frame"in t&&r(4,E=t.frame),"speed"in t&&r(5,x=t.speed),"hasErrorInCode"in t&&r(3,F=t.hasErrorInCode),"code"in t&&r(6,b=t.code),"n"in t&&r(7,T=t.n),"resolution"in t&&r(0,D=t.resolution)},t.$$.update=()=>{if(48&t.$$.dirty&&r(10,L=S.adjustFrame(E,x)),1312&t.$$.dirty&&a&&0!=x&&L&&B(),384&t.$$.dirty&&a&&T&&(C(a,T),B()),72&t.$$.dirty&&b){let t;r(3,[t,F]=S.createTransformFunction(b),F),F||r(9,s=t)}768&t.$$.dirty&&a&&s&&B()},[D,i,P,F,E,x,b,T,a,s,L,function(t){h[t?"unshift":"push"]((()=>{i=t,r(1,i)}))},()=>P("click")]}class D extends t{constructor(t){super(),e(this,t,T,b,r,{frame:4,speed:5,hasErrorInCode:3,code:6,n:7,resolution:0})}}export{D as C,F as i,S as t};
