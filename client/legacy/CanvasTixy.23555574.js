import{_ as t,a as e,b as n,c as r,i,s as a,d as o,S as s,y as u,A as c,B as f,g as l,E as d,k as h,F as v,l as p,J as m,v as _,T as g,M as y,w as A}from"./client.a38a691e.js";function w(t,e,n){const r=t.createShader(e);t.shaderSource(r,n),t.compileShader(r);if(!t.getShaderParameter(r,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(r);throw t.deleteShader(r),new Error(`Shader compilation error: ${e}`)}return r}function R(t,e,n=null){const r=document.getElementById(e);if(!r)throw new Error(`Couldn't find shader script element wit id #${e}`);if(null==n)if("x-shader/x-vertex"===r.type)n=t.VERTEX_SHADER;else if("x-shader/x-fragment"===r.type)n=t.FRAGMENT_SHADER;else if(n!==t.VERTEX_SHADER&&n!==t.FRAGMENT_SHADER)throw new Error(`Unknown shader type: ${n}`);return w(t,t.VERTEX_SHADER,r.textContent)}function x(t,e,n){const r=t.createProgram();t.attachShader(r,e),t.attachShader(r,n),t.linkProgram(r);if(!t.getProgramParameter(r,t.LINK_STATUS)){const e=t.getProgramInfoLog(r);throw t.deleteProgram(r),new Error(`Error while linking WebGL program: ${e}`)}return r}var b={createShaderFromSource:w,createShaderFromScript:R,createProgram:x,createProgramFromSources:function(t,e,n){return x(t,w(t,t.VERTEX_SHADER,e),w(t,t.FRAGMENT_SHADER,n))},createProgramFromScripts:function(t,e,n){return x(t,R(t,e),R(t,n))},getActiveAttributes:function*(t,e){const n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const n=t.getActiveAttrib(e,r);if(!n)break;yield n}},pointVertexAttrib:function(t,e,n,r=WebGL2RenderingContext.FLOAT,i=!1,a=0,o=0){t.enableVertexAttribArray(e),t.vertexAttribPointer(e,n,r,i,a,o)},clear:function(t,e=0,n=0,r=0,i=0){t.clearColor(e,n,r,i),t.clear(t.COLOR_BUFFER_BIT)},rectangle:function(t,e,n,r){return[t,e,n,e,t,r,t,r,n,e,n,r]}};class E{constructor(t,e,n=16,r=10,i=null){this.name=t,this.code=e,this.n=n,this.speed=r,this.comments=i||new Array(t)}}const S={},F=[],T=[];function B(t,e){S[t]=e,F.push(t)}function C(t,e){S[t]=e,T.push(t)}function P(t){return S[t]}function $(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=e(t);if(r){var o=e(this).constructor;i=Reflect.construct(a,arguments,o)}else i=a.apply(this,arguments);return n(this,i)}}function D(t){var e,n,r;return{c:function(){e=u("canvas"),this.h()},l:function(t){e=c(t,"CANVAS",{width:!0,height:!0,class:!0}),f(e).forEach(l),this.h()},h:function(){d(e,"width",t[0]),d(e,"height",t[0]),d(e,"class","svelte-szljto")},m:function(i,a){h(i,e,a),t[10](e),n||(r=v(e,"click",t[11]),n=!0)},p:function(t,n){var r=p(n,1)[0];1&r&&d(e,"width",t[0]),1&r&&d(e,"height",t[0])},i:m,o:m,d:function(i){i&&l(e),t[10](null),n=!1,r()}}}function I(t,e,n){var r,i,a,o,s,u,c,f,l,d,h,v,p,m,w=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(t){a(t)}}function s(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},R=e.time,x=e.speed,E=e.code,S=e.n,F=e.resolution,T=void 0===F?800:F,B=_();function C(t,e){m=b.rectangle(0,0,1/e,1/e),t.bindBuffer(t.ARRAY_BUFFER,d),t.bufferData(t.ARRAY_BUFFER,new Float32Array(m),t.STATIC_DRAW),t.uniform2f(u,t.canvas.width,t.canvas.height),t.vertexAttrib1f(f,1/e/2),p=[];for(var n=0;n<e;n++)for(var r=0;r<e;r++)p.push((r+.5)/e,(n+.5)/e);t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,new Float32Array(p),t.STATIC_DRAW)}function P(){i.useProgram(a),b.clear(i),function(){for(var t,e,n,r=[],a=0;a<S;a++)for(var s=0;s<S;s++)r.push((t=o($,s+a*S,s,a,S),e=-1,n=1,Math.min(Math.max(t,e),n)));i.bindBuffer(i.ARRAY_BUFFER,v),i.bufferData(i.ARRAY_BUFFER,new Float32Array(r),i.STATIC_DRAW)}(),i.bindBuffer(i.ARRAY_BUFFER,v),b.pointVertexAttrib(i,l,1),i.vertexAttribDivisor(l,1),i.drawArraysInstanced(i.TRIANGLES,0,m.length/2,S*S)}g((function(){return w(void 0,void 0,void 0,y.mark((function t(){return y.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n(7,i=r.getContext("webgl2")),a=b.createProgramFromSources(i,"\n\t\t\tuniform vec2 u_resolution;\n\t\t\tattribute vec2 a_position;\n\t\t\tattribute vec2 a_center;\n\t\t\tattribute float a_radius;\n\t\t\tattribute float a_transform;\n\n\t\t\tvarying vec2 v_resolution;\n\t\t\tvarying vec2 v_center;\n\t\t\tvarying float v_radius;\n\t\t\tvarying float v_transform;\n\n\t\t\tvoid main() {\n\t\t\t\tvec2 pos = (a_position + a_center + vec2(-a_radius, -a_radius)) * vec2(2,-2) + vec2(-1,1);\n\t\t\t\tgl_Position = vec4(pos,0,1);\n\n\t\t\t\tv_resolution = u_resolution;\n\t\t\t\tv_center = a_center;\n\t\t\t\tv_radius = a_radius;\n\t\t\t\tv_transform = a_transform;\n\t\t\t}\n\t\t","\n\t\t\tprecision mediump float;\n\n\t\t\tvarying vec2 v_resolution;\n\t\t\tvarying vec2 v_center;\n\t\t\tvarying float v_radius;\n\t\t\tvarying float v_transform;\n\n\t\t\tvoid main() {\n\t\t\t\tvec2 normalizedCoord = gl_FragCoord.xy/v_resolution * vec2(1,-1) + vec2(0,+1);\n\n\t\t\t\tfloat dx = v_center[0] - normalizedCoord.x;\n\t\t\t\tfloat dy = v_center[1] - normalizedCoord.y;\n\n\t\t\t\tfloat distance = sqrt(dx*dx + dy*dy);\n\t\t\t\tfloat radius = v_radius * abs(v_transform);\n\t\t\t\tvec4 color = v_transform < .0 ? vec4(1,0,0,1) : vec4(1,1,1,1);\n\n\t\t\t\tgl_FragColor += color * smoothstep(radius, radius-0.003, distance);\n\t\t\t}\n\t\t"),u=i.getUniformLocation(a,"u_resolution"),f=i.getAttribLocation(a,"a_radius"),c=i.getAttribLocation(a,"a_center"),h=i.createBuffer(),s=i.getAttribLocation(a,"a_position"),d=i.createBuffer(),l=i.getAttribLocation(a,"a_transform"),v=i.createBuffer(),i.viewport(0,0,i.canvas.width,i.canvas.height),C(i,S),i.bindBuffer(i.ARRAY_BUFFER,h),b.pointVertexAttrib(i,c,2),i.vertexAttribDivisor(c,1),i.bindBuffer(i.ARRAY_BUFFER,d),b.pointVertexAttrib(i,s,2),P();case 8:case"end":return t.stop()}}),t)})))}));var $;return t.$$set=function(t){"time"in t&&n(3,R=t.time),"speed"in t&&n(4,x=t.speed),"code"in t&&n(5,E=t.code),"n"in t&&n(6,S=t.n),"resolution"in t&&n(0,T=t.resolution)},t.$$.update=function(){24&t.$$.dirty&&n(9,$=R/1e4*x),656&t.$$.dirty&&i&&0!=x&&$&&P(),192&t.$$.dirty&&i&&S&&(C(i,S),P()),32&t.$$.dirty&&E&&n(8,o=function(t){try{return new Function("t","i","x","y","n",`\n\t\t\ttry {\n\t\t\t\twith(Math) {\n\t\t\t\t\t${t}\n\t\t\t\t};\n\t\t\t} catch(e) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t`)}catch(t){return()=>1}}(E)),384&t.$$.dirty&&i&&o&&P()},[T,r,B,R,x,E,S,i,o,$,function(t){A[t?"unshift":"push"]((function(){n(1,r=t)}))},function(){return B("click")}]}B("sweep_up",new E("Sweep up","return sin(y/8+t);",16)),B("pulse",new E("Pulse","return sin(t);",16)),B("ripple_in",new E("Ripple In","return sin(sqrt(pow(n/2-x-0.5,2)+pow(n/2-y-0.5,2))+t);",16)),B("ripple_circ",new E("Circular Ripple","let radius = n/4;return sin(sqrt(pow(n/2-x-0.5+sin(t)*radius,2)+pow(n/2-y-0.5+cos(t)*radius,2))+t);",16)),B("triangle",new E("Triangle","return y+1>x && n-2-y<x;",16,0)),B("triangle-up",new E("Flying Triangle","let h=t*3%n;return y>x-h && y>n-1-x-h && y<n-h;",16)),B("grid",new E("Grid","return x%4 && y%4",16)),B("sirpinski",new E('<a href="https://en.wikipedia.org/wiki/Sierpi%C5%84ski_triangle">Sirpinski </a>',"return i & x & y & t*2",16)),C("tut-start",new E("","return sin(y/8+t);",16,10,['Inspired by <a href="https://tixy.land">tixy.land</a>',"Start the tutorial by clicking the dots"])),C("tut-visibility",new E("","return i%3 == 0;",16,0,["0/1 = false/true => hide/show dots"])),C("tut-scale",new E("","return abs(sin(x/3))",16,0,["use a number from 0 to 1 to define the dot size"])),C("tut-time",new E("","return sin(t);",16,10,["'t' is the time in seconds"])),C("tut-index",new E("","return i/pow(n,2);",16,0,["'i' is the index of the dot, from 0 to nÂ²-1"])),C("tut-x",new E("","return x/n;",16,0,["'x' is the column, 0..n-1"])),C("tut-y",new E("","return y/n;",16,0,["'y' is the row, 0..n-1"])),C("tut-color",new E("","return y-(n/2-0.5);",16,0,["positive numbers are white","negatives are red"])),C("tut-animate",new E("","return y-t;",16,10,["use 't' to animate values"])),C("tut-animate-faster",new E("","return y-t*2;",16,10,["multiply 't' to change the speed"])),C("tut-pattern",new E("","return [0.25, -0.5, 0.75, -1][i%4]",16,0,["Create patterns using arrays"])),C("tut-end",new E("","return sin(t)",16,10,["Edit the code to create your own","Have fun :)"]));var U=function(e){t(u,s);var n=$(u);function u(t){var e;return r(this,u),e=n.call(this),i(o(e),t,I,D,a,{time:3,speed:4,code:5,n:6,resolution:0}),e}return u}();export{U as C,F as a,P as g,T as t};
