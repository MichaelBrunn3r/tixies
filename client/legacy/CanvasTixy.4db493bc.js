import{_ as t,a as e,b as n,c as r,i,s,d as o,S as a,p as u,r as c,u as l,g as h,F as _,k as f,v as A,l as T,K as p,B as d,C as g,L as E,D as y}from"./client.f745d15d.js";function v(t,e,n){const r=t.createShader(e);t.shaderSource(r,n),t.compileShader(r);if(!t.getShaderParameter(r,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(r);throw t.deleteShader(r),new Error(`Shader compilation error: ${e}`)}return r}function L(t,e,n=null){const r=document.getElementById(e);if(!r)throw new Error(`Couldn't find shader script element wit id #${e}`);if(null==n)if("x-shader/x-vertex"===r.type)n=t.VERTEX_SHADER;else if("x-shader/x-fragment"===r.type)n=t.FRAGMENT_SHADER;else if(n!==t.VERTEX_SHADER&&n!==t.FRAGMENT_SHADER)throw new Error(`Unknown shader type: ${n}`);return v(t,t.VERTEX_SHADER,r.textContent)}function O(t,e,n){const r=t.createProgram();t.attachShader(r,e),t.attachShader(r,n),t.linkProgram(r);if(!t.getProgramParameter(r,t.LINK_STATUS)){const e=t.getProgramInfoLog(r);throw t.deleteProgram(r),new Error(`Error while linking WebGL program: ${e}`)}return r}var F,m;!function(t){t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.DEFAULT=5126]="DEFAULT"}(F||(F={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.DEFAULT=5126]="DEFAULT"}(m||(m={}));class x{constructor(t,e,n,r,i){this.gl=t,this.size=e,this.type=F[F[n]],this.name=r,this.location=i,this._get_set_fn()}set(t){this.set_fn(t)}_get_set_fn(){this.type==F.FLOAT?this.set_fn=t=>this.gl.vertexAttrib1f(this.location,t):this.type==F.BOOL_VEC2||this.type==F.INT_VEC2||this.type==F.FLOAT_VEC2?this.set_fn=t=>this.gl.vertexAttrib2f(this.location,t[0],t[1]):this.type==F.BOOL_VEC3||this.type==F.INT_VEC3||this.type==F.FLOAT_VEC3?this.set_fn=t=>this.gl.vertexAttrib3f(this.location,t[0],t[1],t[2]):this.type!=F.BOOL_VEC4&&this.type!=F.INT_VEC4&&this.type!=F.FLOAT_VEC4||(this.set_fn=t=>this.gl.vertexAttrib4f(this.location,t[0],t[1],t[2],t[3]))}}class C{constructor(t,e,n,r,i){this.gl=t,this.size=e,this.type=m[m[n]],this.name=r,this.location=i,this._get_set_fn()}set(t){this.set_fn(t)}_get_set_fn(){this.type==m.FLOAT?this.set_fn=t=>this.gl.uniform1f(this.location,t):this.type==m.BOOL_VEC2||this.type==m.INT_VEC2||this.type==m.FLOAT_VEC2?this.set_fn=t=>this.gl.uniform2f(this.location,t[0],t[1]):this.type==m.BOOL_VEC3||this.type==m.INT_VEC3||this.type==m.FLOAT_VEC3?this.set_fn=t=>this.gl.uniform3f(this.location,t[0],t[1],t[2]):this.type!=m.BOOL_VEC4&&this.type!=m.INT_VEC4&&this.type!=m.FLOAT_VEC4||(this.set_fn=t=>this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class w{constructor(t,e){this.attribs={},this.uniforms={},this.gl=t,this.prog=e,this._get_attribs(),this._get_uniforms()}static fromSources(t,e,n){return new w(t,O(t,v(t,t.VERTEX_SHADER,e),v(t,t.FRAGMENT_SHADER,n)))}static fromScripts(t,e,n){return new w(t,O(t,L(t,e),L(t,n)))}use(){this.gl.useProgram(this.prog)}clear(t=0,e=0,n=0,r=0){this.gl.clearColor(t,e,n,r),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}location(t){return this.attribs[t].location}attribDivisor(t,e){this.gl.vertexAttribDivisor(this.attribs[t].location,e)}bufferData(t,e,n=WebGL2RenderingContext.STATIC_DRAW){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(e),n)}pointAttr(t,e,n,r=!1,i=0,s=0){const o=this.attribs[e];this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.enableVertexAttribArray(o.location),this.gl.vertexAttribPointer(o.location,n,this.gl.FLOAT,r,i,s)}_get_attribs(){const t=this.gl.getProgramParameter(this.prog,this.gl.ACTIVE_ATTRIBUTES);for(let e=0;e<t;e++){const t=this.gl.getActiveAttrib(this.prog,e);if(!t)break;this.attribs[t.name]=new x(this.gl,t.size,t.type,t.name,this.gl.getAttribLocation(this.prog,t.name))}}_get_uniforms(){const t=this.gl.getProgramParameter(this.prog,this.gl.ACTIVE_UNIFORMS);for(let e=0;e<t;e++){const t=this.gl.getActiveUniform(this.prog,e);if(!t)break;this.uniforms[t.name]=new C(this.gl,t.size,t.type,t.name,this.gl.getUniformLocation(this.prog,t.name))}}}var V={rectangle:function(t,e,n,r){return[t,e,n,e,t,r,t,r,n,e,n,r]}};class S{constructor(t,e,n=16,r=(S.DEFAULT_SPEED=100),i=null){this.name=t,this.code=e,this.n=n,this.speed=r,this.comments=i||new Array(t)}}S.DEFAULT_SPEED=100;const b={},M=[],D=[];function I(t,e){b[t]=e,M.push(t)}function R(t,e){b[t]=e,D.push(t)}I("sweep_up",new S("Sweep up","return sin(y/8+t);",16)),I("pulse",new S("Pulse","return sin(t);",16)),I("ripple_in",new S("Ripple In","return sin(sqrt(pow(n/2-x-0.5,2)+pow(n/2-y-0.5,2))+t);",16)),I("ripple_circ",new S("Circular Ripple","let radius = n/4;return sin(sqrt(pow(n/2-x-0.5+sin(t)*radius,2)+pow(n/2-y-0.5+cos(t)*radius,2))+t);",16)),I("triangle",new S("Triangle","return y+1>x && n-2-y<x;",16,0)),I("triangle-up",new S("Flying Triangle","let h=t*3%n;return y>x-h && y>n-1-x-h && y<n-h;",16)),I("grid",new S("Grid","return x%4 && y%4",16)),I("sirpinski",new S('<a href="https://en.wikipedia.org/wiki/Sierpi%C5%84ski_triangle">Sirpinski </a>',"return i & x & y & t*2",16)),I("square-collapse",new S("Collapsing Square","let v = ceil(t%(n/2)-1);return (x == v || n-1-x == v || y == v || n-1-y == v) && (x>v-1 && x<n-v && y>v-1 && y<n-v)")),I("ladder-blink",new S("Blinking Ladder","let px = floor(t%n);let py = floor((t/n)%n);return (x == (py%2 ? px : n-1-px) && y == py) * (i%2*-2+1)",6,2*S.DEFAULT_SPEED)),I("swiper",new S("Swiper","t*=14;let period = 2*n-2;return x == (floor(t%period) < period/2 ? floor(t%(period/2)): n-1-floor(t%(period/2)));",16)),I("swiper_laola",new S("Laola Swiper","return abs(floor(sin(t)*(n-1))) == x",16)),I("pong",new S("Pong","t=floor(t*3);\n\t\t\t\t\t\t\t\t\t\t\tlet px=2*(n-1)-2;\n\t\t\t\t\t\t\t\t\t\t\tlet ratio=2;\n\t\t\t\t\t\t\t\t\t\t\tlet py=(px+2)/ratio;\n\t\t\t\t\t\t\t\t\t\t\tlet ty= t+px/ratio/4;\n\t\t\t\t\t\t\t\t\t\t\tlet posy= y == floor((ty%py < py/2 ? ty*ratio%(n-1): n-1-ty*ratio%(n-1)));\n\t\t\t\t\t\t\t\t\t\t\tlet posx = x == 1+floor((t%px < px/2 ? t%(n-2): n-3-t%(n-2)));\n\t\t\t\t\t\t\t\t\t\t\tlet isPaddle = (x==0 || x==n-1) && (ty%py < py/2 ? (y<ty*ratio%(n-1)+2&& y>ty*ratio%(n-1)-2) : (y<n-1-ty*ratio%(n-1)+2 && y>n-1-ty*ratio%(n-1)-2));\n\t\t\t\t\t\t\t\t\t\t\treturn isPaddle ? -1 : (posx && posy);",16)),R("tut-start",new S("","return sin(y/8+t);",16,S.DEFAULT_SPEED,['Inspired by <a href="https://tixy.land">tixy.land</a>',"Start the tutorial by clicking the dots"])),R("tut-visibility",new S("","return i%3 == 0;",16,0,["0/1 = false/true => hide/show dots"])),R("tut-scale",new S("","return abs(sin(x/3))",16,0,["use a number from 0 to 1 to define the dot size"])),R("tut-time",new S("","return sin(t);",16,S.DEFAULT_SPEED,["'t' is the time in seconds"])),R("tut-index",new S("","return i/pow(n,2);",16,0,["'i' is the index of the dot, from 0 to nÂ²-1"])),R("tut-x",new S("","return x/n;",16,0,["'x' is the column, 0..n-1"])),R("tut-y",new S("","return y/n;",16,0,["'y' is the row, 0..n-1"])),R("tut-color",new S("","return y-(n/2-0.5);",16,0,["positive numbers are white","negatives are red"])),R("tut-animate",new S("","return y-t;",16,S.DEFAULT_SPEED,["use 't' to animate values"])),R("tut-animate-faster",new S("","return y-t*2;",16,S.DEFAULT_SPEED,["multiply 't' to change the speed"])),R("tut-pattern",new S("","return [0.25, -0.5, 0.75, -1][i%4]",16,0,["Create patterns using arrays"])),R("tut-end",new S("","return sin(t)",16,S.DEFAULT_SPEED,["Edit the code to create your own","Have fun :)"]));var B={get:function(t){return b[t]},gallery:M,tutorial:D,createTransformFunction:function(t){let e,n=!1;try{e=new Function("t","i","x","y","n",`\n\t\t\t\ttry {\n\t\t\t\t\twith(Math) {\n\t\t\t\t\t\t${t}\n\t\t\t\t\t};\n\t\t\t\t} catch(e) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t`)}catch(t){n=!0}return[e,n]},adjustFrame:function(t,e){return t/1e4*e},frameAdjustmentFactor:1e4};var P={vertexShaderSource:"\n\tuniform vec2 u_resolution;\n\tattribute vec2 a_position;\n\tattribute vec2 a_center;\n\tattribute float a_radius;\n\tattribute float a_transform;\n\n\tvarying vec2 v_resolution;\n\tvarying vec2 v_center;\n\tvarying float v_radius;\n\tvarying float v_transform;\n\n\tvoid main() {\n\t\tvec2 pos = (a_position + a_center + vec2(-a_radius, -a_radius)) * vec2(2,-2) + vec2(-1,1);\n\t\tgl_Position = vec4(pos,0,1);\n\n\t\tv_resolution = u_resolution;\n\t\tv_center = a_center;\n\t\tv_radius = a_radius;\n\t\tv_transform = a_transform;\n\t}\n",fragmentShaderSource:"\n\tprecision mediump float;\n\n\tvarying vec2 v_resolution;\n\tvarying vec2 v_center;\n\tvarying float v_radius;\n\tvarying float v_transform;\n\n\tvoid main() {\n\t\tvec2 normalizedCoord = gl_FragCoord.xy/v_resolution * vec2(1,-1) + vec2(0,+1);\n\n\t\tfloat dx = v_center[0] - normalizedCoord.x;\n\t\tfloat dy = v_center[1] - normalizedCoord.y;\n\n\t\tfloat distance = sqrt(dx*dx + dy*dy);\n\t\tfloat radius = v_radius * abs(v_transform);\n\t\tvec4 color = v_transform < .0 ? vec4(1,0,0,1) : vec4(1,1,1,1);\n\n\t\tgl_FragColor += color * smoothstep(radius, radius-0.003, distance);\n\t}\n"};function N(t){return!isNaN(t)}function U(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=e(t);if(r){var o=e(this).constructor;i=Reflect.construct(s,arguments,o)}else i=s.apply(this,arguments);return n(this,i)}}function $(t){var e,n,r;return{c:function(){e=u("canvas"),this.h()},l:function(t){e=c(t,"CANVAS",{width:!0,height:!0,class:!0}),l(e).forEach(h),this.h()},h:function(){_(e,"width",t[0]),_(e,"height",t[0]),_(e,"class","svelte-szljto")},m:function(i,s){f(i,e,s),t[11](e),n||(r=A(e,"click",t[12]),n=!0)},p:function(t,n){var r=T(n,1)[0];1&r&&_(e,"width",t[0]),1&r&&_(e,"height",t[0])},i:p,o:p,d:function(i){i&&h(e),t[11](null),n=!1,r()}}}function k(t,e,n){var r,i,s,o,a,u,c,l,h,_=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((r=r.apply(t,e||[])).next())}))},f=e.frame,A=e.speed,p=e.hasErrorInCode,v=void 0!==p&&p,L=e.code,O=e.n,F=e.resolution,m=void 0===F?800:F,x=d();function C(t,e){h=V.rectangle(0,0,1/e,1/e),s.bufferData(a,h),s.uniforms.u_resolution.set([t.canvas.width,t.canvas.height]),s.attribs.a_radius.set(1/e/2),l=[];for(var n=0;n<e;n++)for(var r=0;r<e;r++)l.push((r+.5)/e,(n+.5)/e);s.bufferData(u,l)}function S(){s.use(),s.clear(),function(){for(var t,e,n,r=[],i=0;i<O;i++)for(var a=0;a<O;a++)r.push((t=o(b,a+i*O,a,i,O),e=-1,n=1,Math.min(Math.max(t,e),n)));s.bufferData(c,r)}(),s.pointAttr(c,"a_transform",1),s.attribDivisor("a_transform",1),i.drawArraysInstanced(i.TRIANGLES,0,h.length/2,O*O)}g((function(){return _(void 0,void 0,void 0,E.mark((function t(){return E.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n(8,i=r.getContext("webgl2")),s=w.fromSources(i,P.vertexShaderSource,P.fragmentShaderSource),u=i.createBuffer(),a=i.createBuffer(),c=i.createBuffer(),i.viewport(0,0,i.canvas.width,i.canvas.height),C(i,O),s.pointAttr(u,"a_center",2),s.attribDivisor("a_center",1),s.pointAttr(a,"a_position",2),S();case 6:case"end":return t.stop()}}),t)})))}));var b;return t.$$set=function(t){"frame"in t&&n(4,f=t.frame),"speed"in t&&n(5,A=t.speed),"hasErrorInCode"in t&&n(3,v=t.hasErrorInCode),"code"in t&&n(6,L=t.code),"n"in t&&n(7,O=t.n),"resolution"in t&&n(0,m=t.resolution)},t.$$.update=function(){var e,r,s;(48&t.$$.dirty&&n(10,b=B.adjustFrame(f,A)),1312&t.$$.dirty&&i&&0!=A&&b&&S(),384&t.$$.dirty&&i&&O&&(C(i,O),S()),72&t.$$.dirty)&&(L&&(n(3,(e=B.createTransformFunction(L),s=(r=T(e,2))[0],v=r[1],e),v),v||n(9,o=s)));768&t.$$.dirty&&i&&o&&S()},[m,r,x,v,f,A,L,O,i,o,b,function(t){y[t?"unshift":"push"]((function(){n(1,r=t)}))},function(){return x("click")}]}var z=function(e){t(u,a);var n=U(u);function u(t){var e;return r(this,u),e=n.call(this),i(o(e),t,k,$,s,{frame:4,speed:5,hasErrorInCode:3,code:6,n:7,resolution:0}),e}return u}();export{z as C,N as i,B as t};
