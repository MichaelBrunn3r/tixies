import{_ as t,a as r,b as e,c as n,i,s as a,d as o,S as s,p as u,r as c,u as f,g as l,F as d,k as h,v,l as p,K as m,B as _,C as y,L as A,D as g}from"./client.d7377364.js";function w(t,r,e){const n=t.createShader(r);t.shaderSource(n,e),t.compileShader(n);if(!t.getShaderParameter(n,t.COMPILE_STATUS)){const r=t.getShaderInfoLog(n);throw t.deleteShader(n),new Error(`Shader compilation error: ${r}`)}return n}function E(t,r,e=null){const n=document.getElementById(r);if(!n)throw new Error(`Couldn't find shader script element wit id #${r}`);if(null==e)if("x-shader/x-vertex"===n.type)e=t.VERTEX_SHADER;else if("x-shader/x-fragment"===n.type)e=t.FRAGMENT_SHADER;else if(e!==t.VERTEX_SHADER&&e!==t.FRAGMENT_SHADER)throw new Error(`Unknown shader type: ${e}`);return w(t,t.VERTEX_SHADER,n.textContent)}function S(t,r,e){const n=t.createProgram();t.attachShader(n,r),t.attachShader(n,e),t.linkProgram(n);if(!t.getProgramParameter(n,t.LINK_STATUS)){const r=t.getProgramInfoLog(n);throw t.deleteProgram(n),new Error(`Error while linking WebGL program: ${r}`)}return n}var x={createShaderFromSource:w,createShaderFromScript:E,createProgram:S,createProgramFromSources:function(t,r,e){return S(t,w(t,t.VERTEX_SHADER,r),w(t,t.FRAGMENT_SHADER,e))},createProgramFromScripts:function(t,r,e){return S(t,E(t,r),E(t,e))},getActiveAttributes:function*(t,r){const e=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES);for(let n=0;n<e;n++){const e=t.getActiveAttrib(r,n);if(!e)break;yield e}},pointVertexAttrib:function(t,r,e,n=WebGL2RenderingContext.FLOAT,i=!1,a=0,o=0){t.enableVertexAttribArray(r),t.vertexAttribPointer(r,e,n,i,a,o)},clear:function(t,r=0,e=0,n=0,i=0){t.clearColor(r,e,n,i),t.clear(t.COLOR_BUFFER_BIT)},rectangle:function(t,r,e,n){return[t,r,e,r,t,n,t,n,e,r,e,n]}};class R{constructor(t,r,e=16,n=(R.DEFAULT_SPEED=100),i=null){this.name=t,this.code=r,this.n=e,this.speed=n,this.comments=i||new Array(t)}}R.DEFAULT_SPEED=100;const F={},b=[],T=[];function D(t,r){F[t]=r,b.push(t)}function P(t,r){F[t]=r,T.push(t)}D("sweep_up",new R("Sweep up","return sin(y/8+t);",16)),D("pulse",new R("Pulse","return sin(t);",16)),D("ripple_in",new R("Ripple In","return sin(sqrt(pow(n/2-x-0.5,2)+pow(n/2-y-0.5,2))+t);",16)),D("ripple_circ",new R("Circular Ripple","let radius = n/4;return sin(sqrt(pow(n/2-x-0.5+sin(t)*radius,2)+pow(n/2-y-0.5+cos(t)*radius,2))+t);",16)),D("triangle",new R("Triangle","return y+1>x && n-2-y<x;",16,0)),D("triangle-up",new R("Flying Triangle","let h=t*3%n;return y>x-h && y>n-1-x-h && y<n-h;",16)),D("grid",new R("Grid","return x%4 && y%4",16)),D("sirpinski",new R('<a href="https://en.wikipedia.org/wiki/Sierpi%C5%84ski_triangle">Sirpinski </a>',"return i & x & y & t*2",16)),D("square-collapse",new R("Collapsing Square","let v = ceil(t%(n/2)-1);return (x == v || n-1-x == v || y == v || n-1-y == v) && (x>v-1 && x<n-v && y>v-1 && y<n-v)")),D("ladder-blink",new R("Blinking Ladder","let px = floor(t%n);let py = floor((t/n)%n);return (x == (py%2 ? px : n-1-px) && y == py) * (i%2*-2+1)",6,2*R.DEFAULT_SPEED)),D("swipper",new R("Swipper","return abs(floor(sin(t)*(n-1))) == x",16)),P("tut-start",new R("","return sin(y/8+t);",16,R.DEFAULT_SPEED,['Inspired by <a href="https://tixy.land">tixy.land</a>',"Start the tutorial by clicking the dots"])),P("tut-visibility",new R("","return i%3 == 0;",16,0,["0/1 = false/true => hide/show dots"])),P("tut-scale",new R("","return abs(sin(x/3))",16,0,["use a number from 0 to 1 to define the dot size"])),P("tut-time",new R("","return sin(t);",16,R.DEFAULT_SPEED,["'t' is the time in seconds"])),P("tut-index",new R("","return i/pow(n,2);",16,0,["'i' is the index of the dot, from 0 to nÂ²-1"])),P("tut-x",new R("","return x/n;",16,0,["'x' is the column, 0..n-1"])),P("tut-y",new R("","return y/n;",16,0,["'y' is the row, 0..n-1"])),P("tut-color",new R("","return y-(n/2-0.5);",16,0,["positive numbers are white","negatives are red"])),P("tut-animate",new R("","return y-t;",16,R.DEFAULT_SPEED,["use 't' to animate values"])),P("tut-animate-faster",new R("","return y-t*2;",16,R.DEFAULT_SPEED,["multiply 't' to change the speed"])),P("tut-pattern",new R("","return [0.25, -0.5, 0.75, -1][i%4]",16,0,["Create patterns using arrays"])),P("tut-end",new R("","return sin(t)",16,R.DEFAULT_SPEED,["Edit the code to create your own","Have fun :)"]));var C={get:function(t){return F[t]},gallery:b,tutorial:T,createTransformFunction:function(t){let r,e=!1;try{r=new Function("t","i","x","y","n",`\n\t\t\t\ttry {\n\t\t\t\t\twith(Math) {\n\t\t\t\t\t\t${t}\n\t\t\t\t\t};\n\t\t\t\t} catch(e) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t`)}catch(t){e=!0}return[r,e]},adjustFrame:function(t,r){return t/1e4*r},frameAdjustmentFactor:1e4};var B={vertexShaderSource:"\n\tuniform vec2 u_resolution;\n\tattribute vec2 a_position;\n\tattribute vec2 a_center;\n\tattribute float a_radius;\n\tattribute float a_transform;\n\n\tvarying vec2 v_resolution;\n\tvarying vec2 v_center;\n\tvarying float v_radius;\n\tvarying float v_transform;\n\n\tvoid main() {\n\t\tvec2 pos = (a_position + a_center + vec2(-a_radius, -a_radius)) * vec2(2,-2) + vec2(-1,1);\n\t\tgl_Position = vec4(pos,0,1);\n\n\t\tv_resolution = u_resolution;\n\t\tv_center = a_center;\n\t\tv_radius = a_radius;\n\t\tv_transform = a_transform;\n\t}\n",fragmentShaderSource:"\n\tprecision mediump float;\n\n\tvarying vec2 v_resolution;\n\tvarying vec2 v_center;\n\tvarying float v_radius;\n\tvarying float v_transform;\n\n\tvoid main() {\n\t\tvec2 normalizedCoord = gl_FragCoord.xy/v_resolution * vec2(1,-1) + vec2(0,+1);\n\n\t\tfloat dx = v_center[0] - normalizedCoord.x;\n\t\tfloat dy = v_center[1] - normalizedCoord.y;\n\n\t\tfloat distance = sqrt(dx*dx + dy*dy);\n\t\tfloat radius = v_radius * abs(v_transform);\n\t\tvec4 color = v_transform < .0 ? vec4(1,0,0,1) : vec4(1,1,1,1);\n\n\t\tgl_FragColor += color * smoothstep(radius, radius-0.003, distance);\n\t}\n"};function L(t){return!isNaN(t)}function U(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,a=r(t);if(n){var o=r(this).constructor;i=Reflect.construct(a,arguments,o)}else i=a.apply(this,arguments);return e(this,i)}}function I(t){var r,e,n;return{c:function(){r=u("canvas"),this.h()},l:function(t){r=c(t,"CANVAS",{width:!0,height:!0,class:!0}),f(r).forEach(l),this.h()},h:function(){d(r,"width",t[0]),d(r,"height",t[0]),d(r,"class","svelte-szljto")},m:function(i,a){h(i,r,a),t[11](r),e||(n=v(r,"click",t[12]),e=!0)},p:function(t,e){var n=p(e,1)[0];1&n&&d(r,"width",t[0]),1&n&&d(r,"height",t[0])},i:m,o:m,d:function(i){i&&l(r),t[11](null),e=!1,n()}}}function $(t,r,e){var n,i,a,o,s,u,c,f,l,d,h,v,m,w,E=this&&this.__awaiter||function(t,r,e,n){return new(e||(e=Promise))((function(i,a){function o(t){try{u(n.next(t))}catch(t){a(t)}}function s(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var r;t.done?i(t.value):(r=t.value,r instanceof e?r:new e((function(t){t(r)}))).then(o,s)}u((n=n.apply(t,r||[])).next())}))},S=r.frame,R=r.speed,F=r.hasErrorInCode,b=void 0!==F&&F,T=r.code,D=r.n,P=r.resolution,L=void 0===P?800:P,U=_();function I(t,r){w=x.rectangle(0,0,1/r,1/r),t.bindBuffer(t.ARRAY_BUFFER,d),t.bufferData(t.ARRAY_BUFFER,new Float32Array(w),t.STATIC_DRAW),t.uniform2f(u,t.canvas.width,t.canvas.height),t.vertexAttrib1f(f,1/r/2),m=[];for(var e=0;e<r;e++)for(var n=0;n<r;n++)m.push((n+.5)/r,(e+.5)/r);t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,new Float32Array(m),t.STATIC_DRAW)}function $(){i.useProgram(a),x.clear(i),function(){for(var t,r,e,n=[],a=0;a<D;a++)for(var s=0;s<D;s++)n.push((t=o(k,s+a*D,s,a,D),r=-1,e=1,Math.min(Math.max(t,r),e)));i.bindBuffer(i.ARRAY_BUFFER,v),i.bufferData(i.ARRAY_BUFFER,new Float32Array(n),i.STATIC_DRAW)}(),i.bindBuffer(i.ARRAY_BUFFER,v),x.pointVertexAttrib(i,l,1),i.vertexAttribDivisor(l,1),i.drawArraysInstanced(i.TRIANGLES,0,w.length/2,D*D)}y((function(){return E(void 0,void 0,void 0,A.mark((function t(){return A.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(8,i=n.getContext("webgl2")),a=x.createProgramFromSources(i,B.vertexShaderSource,B.fragmentShaderSource),u=i.getUniformLocation(a,"u_resolution"),f=i.getAttribLocation(a,"a_radius"),c=i.getAttribLocation(a,"a_center"),h=i.createBuffer(),s=i.getAttribLocation(a,"a_position"),d=i.createBuffer(),l=i.getAttribLocation(a,"a_transform"),v=i.createBuffer(),i.viewport(0,0,i.canvas.width,i.canvas.height),I(i,D),i.bindBuffer(i.ARRAY_BUFFER,h),x.pointVertexAttrib(i,c,2),i.vertexAttribDivisor(c,1),i.bindBuffer(i.ARRAY_BUFFER,d),x.pointVertexAttrib(i,s,2),$();case 8:case"end":return t.stop()}}),t)})))}));var k;return t.$$set=function(t){"frame"in t&&e(4,S=t.frame),"speed"in t&&e(5,R=t.speed),"hasErrorInCode"in t&&e(3,b=t.hasErrorInCode),"code"in t&&e(6,T=t.code),"n"in t&&e(7,D=t.n),"resolution"in t&&e(0,L=t.resolution)},t.$$.update=function(){var r,n,a;(48&t.$$.dirty&&e(10,k=C.adjustFrame(S,R)),1312&t.$$.dirty&&i&&0!=R&&k&&$(),384&t.$$.dirty&&i&&D&&(I(i,D),$()),72&t.$$.dirty)&&(T&&(e(3,(r=C.createTransformFunction(T),a=(n=p(r,2))[0],b=n[1],r),b),b||e(9,o=a)));768&t.$$.dirty&&i&&o&&$()},[L,n,U,b,S,R,T,D,i,o,k,function(t){g[t?"unshift":"push"]((function(){e(1,n=t)}))},function(){return U("click")}]}var k=function(r){t(u,s);var e=U(u);function u(t){var r;return n(this,u),r=e.call(this),i(o(r),t,$,I,a,{frame:4,speed:5,hasErrorInCode:3,code:6,n:7,resolution:0}),r}return u}();export{k as C,L as i,C as t};
